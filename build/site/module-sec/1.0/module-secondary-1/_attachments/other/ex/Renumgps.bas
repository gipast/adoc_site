10 TRUE=1
12 FOLLOWER=FALSE=0
30 INPUT "ENTER OLD FILE SPEC: ", OLDFILESPEC$
40 INPUT "ENTER NEW FILE SPEC: ", NEWFILESPEC$
50 OPEN OLDFILESPEC$ FOR INPUT AS #1
60 OPEN NEWFILESPEC$ FOR OUTPUT AS #2
70 INPUT "STARTING LINE NUMBER: ",LINENUM!
80 INPUT "LINE NUMBER INCREMENT: ",INCR!
90 CLS:LOCATE 5,20:PRINT "STARTING AT ";TIME$
100 LOCATE 7,20:COLOR  23,7:PRINT "RENUMBERING...   "
110 COLOR 7,0
120 WHILE NOT EOF(1)
130 LINE INPUT #1, BUFFER$
140 IF LEN(BUFFER$)=0 THEN GOTO 230
145 IF FOLLOWER=TRUE THEN GOTO 400
146 IF (LEFT$(BUFFER$,2)=" *") GOTO 220
147 IF (LEFT$(BUFFER$,2)=" ;") GOTO 220
148 IF (LEFT$(BUFFER$,1)="*") GOTO 220
149 IF (LEFT$(BUFFER$,1)="*") GOTO 220
151 IF (ASC(LEFT$(BUFFER$,1))<ASC("0") OR ASC(LEFT$(BUFFER$,1))>ASC("9")) THEN BUFFER$=" "+BUFFER$ ELSE BUFFER$="0"+BUFFER$
154 WHILE (ASC(LEFT$(BUFFER$,1))>=ASC("0") AND ASC(LEFT$(BUFFER$,1))<=ASC("9"))
160 BUFFER$=RIGHT$(BUFFER$,LEN(BUFFER$)-1)
170 IF (ASC(LEFT$(BUFFER$,1))>=ASC(" ")) THEN BUFFER$=RIGHT$(BUFFER$,LEN(BUFFER$)-1)
180 WEND
185 IF (LEFT$(BUFFER$,1)=" ") THEN BUFFER$=RIGHT$(BUFFER$,LEN(BUFFER$)-1)
190 BUFFER$=STR$(LINENUM!)+" "+BUFFER$
200 IF (ASC(LEFT$(BUFFER$,1))>=ASC(" ")) THEN BUFFER$=RIGHT$(BUFFER$,LEN(BUFFER$)-1)
210 LINENUM!=LINENUM!+INCR!
216 IF (INSTR(BUFFER$,"FUNCTION")>0) THEN FOLLOWER=TRUE
220 PRINT #2,BUFFER$
230 WEND
240 CLOSE
245 CLS
250 SYSTEM
400 IF INSTR(BUFFER$,"ADVANCE") THEN GOTO 700
401 IF INSTR(BUFFER$,"ADVANCE") THEN GOTO 700
402 IF INSTR(BUFFER$,"ALTER") THEN GOTO 700
403 IF INSTR(BUFFER$,"ASSEMBLE") THEN GOTO 700
404 IF INSTR(BUFFER$,"ASSIGN") THEN GOTO 700
405 IF INSTR(BUFFER$,"BUFFER") THEN GOTO 700
406 IF INSTR(BUFFER$,"COUNT") THEN GOTO 700
407 IF INSTR(BUFFER$,"DEPART") THEN GOTO 700
408 IF INSTR(BUFFER$,"ENTER") THEN GOTO 700
409 IF INSTR(BUFFER$,"EXAMINE") THEN GOTO 700
410 IF INSTR(BUFFER$,"EXECUTE") THEN GOTO 700
411 IF INSTR(BUFFER$,"FAVAIL") THEN GOTO 700
412 IF INSTR(BUFFER$,"FUNAVAIL") THEN GOTO 700
413 IF INSTR(BUFFER$,"GATE") THEN GOTO 700
414 IF INSTR(BUFFER$,"GATHER") THEN GOTO 700
415 IF INSTR(BUFFER$,"GENERATE") THEN GOTO 700
416 IF INSTR(BUFFER$,"HELP") THEN GOTO 700
417 IF INSTR(BUFFER$,"INDEX") THEN GOTO 700
418 IF INSTR(BUFFER$,"JOIN") THEN GOTO 700
419 IF INSTR(BUFFER$,"LEAVE") THEN GOTO 700
420 IF INSTR(BUFFER$,"LINK") THEN GOTO 700
421 IF INSTR(BUFFER$,"LOGIC") THEN GOTO 700
422 IF INSTR(BUFFER$,"LOOP") THEN GOTO 700
423 IF INSTR(BUFFER$,"MARK") THEN GOTO 700
424 IF INSTR(BUFFER$,"MATCH") THEN GOTO 700
425 IF INSTR(BUFFER$,"MOVE") THEN GOTO 700
426 IF INSTR(BUFFER$,"MSAVEVALUE") THEN GOTO 700
427 IF INSTR(BUFFER$,"PREEMPT") THEN GOTO 700
428 IF INSTR(BUFFER$,"PRIORITY") THEN GOTO 700
429 IF INSTR(BUFFER$,"QUEUE") THEN GOTO 700
430 IF INSTR(BUFFER$,"RELEASE") THEN GOTO 700
431 IF INSTR(BUFFER$,"REMOVE") THEN GOTO 700
432 IF INSTR(BUFFER$,"RETURN") THEN GOTO 700
433 IF INSTR(BUFFER$,"SAVAIL") THEN GOTO 700
434 IF INSTR(BUFFER$,"SAVEVALUE") THEN GOTO 700
435 IF INSTR(BUFFER$,"SCAN") THEN GOTO 700
436 IF INSTR(BUFFER$,"SEIZE") THEN GOTO 700
437 IF INSTR(BUFFER$,"SELECT") THEN GOTO 700
438 IF INSTR(BUFFER$,"SPLIT") THEN GOTO 700
439 IF INSTR(BUFFER$,"SUNAVAIL") THEN GOTO 700
440 IF INSTR(BUFFER$,"TABULATE") THEN GOTO 700
441 IF INSTR(BUFFER$,"TERMINATE") THEN GOTO 700
442 IF INSTR(BUFFER$,"TEST") THEN GOTO 700
443 IF INSTR(BUFFER$,"TRACE") THEN GOTO 700
444 IF INSTR(BUFFER$,"TRANSFER") THEN GOTO 700
445 IF INSTR(BUFFER$,"UNLINK") THEN GOTO 700
446 IF INSTR(BUFFER$,"UNTRACE") THEN GOTO 700
447 IF INSTR(BUFFER$,"ANOVA") THEN GOTO 700
448 IF INSTR(BUFFER$,"DELETE") THEN GOTO 700
449 IF INSTR(BUFFER$,"DISPLAY") THEN GOTO 700
450 IF INSTR(BUFFER$,"DOS") THEN GOTO 700
451 IF INSTR(BUFFER$,"EDIT") THEN GOTO 700
452 IF INSTR(BUFFER$,"END") THEN GOTO 700
453 IF INSTR(BUFFER$,"EVENTS") THEN GOTO 700
454 IF INSTR(BUFFER$,"GROUPS") THEN GOTO 700
455 IF INSTR(BUFFER$,"RENUMBER") THEN GOTO 700
456 IF INSTR(BUFFER$,"REPORT") THEN GOTO 700
457 IF INSTR(BUFFER$,"RESULT") THEN GOTO 700
458 IF INSTR(BUFFER$,"SAVE") THEN GOTO 700
459 IF INSTR(BUFFER$,"SIMULATE") THEN GOTO 700
460 IF INSTR(BUFFER$,"WINDOW") THEN GOTO 700
461 IF INSTR(BUFFER$,"USERCHAINS") THEN GOTO 700
462 IF INSTR(BUFFER$,"BVARIABLE") THEN GOTO 700
463 IF INSTR(BUFFER$,"CLEAR") THEN GOTO 700
464 IF INSTR(BUFFER$,"CONTINUE") THEN GOTO 700
465 IF INSTR(BUFFER$,"END") THEN GOTO 700
466 IF INSTR(BUFFER$,"EQU") THEN GOTO 700
467 IF INSTR(BUFFER$,"FVARIABLE") THEN GOTO 700
468 IF INSTR(BUFFER$,"FUNCTION") THEN GOTO 700
469 IF INSTR(BUFFER$,"INITIAL") THEN GOTO 700
470 IF INSTR(BUFFER$,"MATRIX") THEN GOTO 700
471 IF INSTR(BUFFER$,"MICROWINDOW") THEN GOTO 700
472 IF INSTR(BUFFER$,"PLOT") THEN GOTO 700
473 IF INSTR(BUFFER$,"QTABLE") THEN GOTO 700
474 IF INSTR(BUFFER$,"RESET") THEN GOTO 700
475 IF INSTR(BUFFER$,"RMULT") THEN GOTO 700
476 IF INSTR(BUFFER$,"SHOW") THEN GOTO 700
477 IF INSTR(BUFFER$,"START") THEN GOTO 700
478 IF INSTR(BUFFER$,"STEP") THEN GOTO 700
479 IF INSTR(BUFFER$,"STOP") THEN GOTO 700
480 IF INSTR(BUFFER$,"STORAGE") THEN GOTO 700
481 IF INSTR(BUFFER$,"TABLE") THEN GOTO 700
482 IF INSTR(BUFFER$,"VARIABLE") THEN GOTO 700
483 IF INSTR(BUFFER$,";") THEN GOTO 700
484 IF INSTR(BUFFER$,"*") THEN GOTO 700
485 IF INSTR(BUFFER$,"ANITRACE") THEN GOTO 700
580 IF (LEFT$(BUFFER$,1)=" ") THEN BUFFER$ = RIGHT$(BUFFER$,LEN(BUFFER$)-1)
600 GOTO 220
700 FOLLOWER=FALSE
800 GOTO 146
